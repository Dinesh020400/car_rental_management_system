{% extends 'base.html' %}

{% block title %}Edit Car - Admin Dashboard{% endblock %}

{% block content %}
<div class="container py-4">
    <div class="row justify-content-center">
        <div class="col-lg-8 fade-in-up">
            <!-- Breadcrumb -->
            <nav aria-label="breadcrumb" class="mb-4">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{{ url_for('admin_dashboard') }}"
                            class="text-decoration-none">Dashboard</a></li>
                    <li class="breadcrumb-item"><a href="{{ url_for('admin_cars') }}"
                            class="text-decoration-none">Vehicles</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Edit Vehicle</li>
                </ol>
            </nav>

            <div class="card border-0 shadow-lg position-relative overflow-hidden rounded-4">
                <div class="card-header bg-white border-0 py-4 px-5">
                    <div class="d-flex align-items-center justify-content-between">
                        <div>
                            <h3 class="fw-bold mb-1">Edit Vehicle Details</h3>
                            <p class="text-muted mb-0 small text-uppercase letter-spacing-1">Id: {{ car.id }}</p>
                        </div>
                        <div class="bg-primary bg-opacity-10 p-3 rounded-circle text-primary">
                            <i class="fas fa-edit fa-lg"></i>
                        </div>
                    </div>
                </div>

                <div class="card-body p-5 pt-0">
                    <form method="POST" action="{{ url_for('admin_edit_car', car_id=car.id) }}">

                        <!-- Vehicle Identity -->
                        <h6 class="fw-bold text-muted text-uppercase small mb-3 mt-2"><i
                                class="fas fa-car me-2"></i>Identification</h6>
                        <div class="row g-4 mb-4">
                            <div class="col-md-6">
                                <label for="make"
                                    class="form-label text-muted small fw-bold text-uppercase">Make</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light border-end-0"><i
                                            class="fas fa-industry text-muted"></i></span>
                                    <input type="text" class="form-control bg-light border-start-0 py-3" id="make"
                                        name="make" value="{{ car.make }}" placeholder="e.g. Toyota" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label for="model"
                                    class="form-label text-muted small fw-bold text-uppercase">Model</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light border-end-0"><i
                                            class="fas fa-car-side text-muted"></i></span>
                                    <input type="text" class="form-control bg-light border-start-0 py-3" id="model"
                                        name="model" value="{{ car.model }}" placeholder="e.g. Camry" required>
                                </div>
                            </div>
                        </div>

                        <!-- Specs & Pricing -->
                        <h6 class="fw-bold text-muted text-uppercase small mb-3"><i class="fas fa-cogs me-2"></i>Specs &
                            Pricing</h6>
                        <div class="row g-4 mb-4">
                            <div class="col-md-4">
                                <label for="year"
                                    class="form-label text-muted small fw-bold text-uppercase">Year</label>
                                <input type="number" class="form-control bg-light py-3" id="year" name="year" min="1900"
                                    max="2100" value="{{ car.year }}" required>
                            </div>
                            <div class="col-md-4">
                                <label for="vehicle_type"
                                    class="form-label text-muted small fw-bold text-uppercase">Type</label>
                                <select class="form-select bg-light py-3 border-0" id="vehicle_type" name="vehicle_type"
                                    required>
                                    <option value="car" {% if car.vehicle_type=='car' %}selected{% endif %}>Car</option>
                                    <option value="bike" {% if car.vehicle_type=='bike' %}selected{% endif %}>Bike
                                    </option>
                                    <option value="scooter" {% if car.vehicle_type=='scooter' %}selected{% endif %}>
                                        Scooter</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label for="price_per_day"
                                    class="form-label text-muted small fw-bold text-uppercase">Daily Rate (₹)</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light border-end-0 fw-bold">₹</span>
                                    <input type="number" class="form-control bg-light border-start-0 py-3"
                                        id="price_per_day" name="price_per_day" min="0" step="0.01"
                                        value="{{ car.price_per_day }}" required>
                                </div>
                            </div>
                        </div>

                        <!-- Visibility & Media -->
                        <h6 class="fw-bold text-muted text-uppercase small mb-3"><i
                                class="fas fa-eye me-2"></i>Visibility & Media</h6>
                        <div class="mb-4">
                            <label for="image" class="form-label text-muted small fw-bold text-uppercase">Image
                                URL</label>
                            <input type="url" class="form-control bg-light py-3 mb-2" id="image" name="image"
                                value="{{ car.image }}" placeholder="https://...">
                            {% if car.image %}
                            <div class="d-flex align-items-center mt-2 p-2 border rounded-3 bg-light">
                                <img src="/static/car_images/{{ car.image.split('/')[-1] if car.image else 'default_car.jpg' }}"
                                    alt="Preview" class="rounded me-3" width="60" height="40"
                                    style="object-fit: cover;">
                                <small class="text-muted">Current Verification Image</small>
                            </div>
                            {% endif %}
                        </div>

                        <div class="mb-5">
                            <div
                                class="form-check form-switch p-3 bg-light rounded-3 d-flex align-items-center justify-content-between">
                                <label class="form-check-label fw-bold ms-2" for="available">Available for
                                    Booking</label>
                                <input class="form-check-input ms-3" type="checkbox" role="switch" id="available"
                                    name="available" style="transform: scale(1.3);" {% if car.available %}checked{%
                                    endif %}>
                            </div>
                        </div>

                        <div class="d-flex justify-content-between align-items-center pt-3 border-top">
                            <a href="{{ url_for('admin_cars') }}"
                                class="btn btn-outline-secondary px-4 fw-bold rounded-pill">Cancel</a>
                            <button type="submit" class="btn btn-primary px-5 py-2 fw-bold shadow-md rounded-pill">
                                Save Changes
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}